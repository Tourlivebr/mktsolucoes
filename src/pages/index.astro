---
import Layout from '../layouts/Layout.astro';

import HeroCarousel from '../components/HeroCarousel.astro';
import SectionIntro from '../components/SectionIntro.astro';
import Benefits from '../components/Benefits.astro';
import Products from '../components/Products.astro';
import Clients from '../components/Clients.astro';

import WhatsForm from '../components/WhatsForm.astro';
import Footer from '../components/Footer.astro';
import WhatsAppFloat from '../components/WhatsAppFloat.astro';
import { siteData } from '../data/site.ts';

// SEO Data
const title = 'MKT Soluções | Estratégias Digitais para seu Negócio';
const description = 'Especialistas em soluções digitais para seu negócio. Sites comerciais, aplicativos, estratégias de marketing e presença digital completa. Aumente a visibilidade da sua empresa e conquiste mais clientes.';
const canonical = 'https://mktsolucoes.com.br';
const image = '/images/logo_mkt.png';
---

<Layout 
  title={title}
  description={description}
  canonical={canonical}
  image={image}
>
  <!-- Schema.org Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "MKT Soluções",
    "url": "https://mktsolucoes.com.br",
    "logo": "https://mktsolucoes.com.br/images/logo_mkt.png",
    "description": "Especialistas em soluções digitais para seu negócio. Sites comerciais, aplicativos, estratégias de marketing e presença digital completa.",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Brasil"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+55-51-99017-3265",
      "contactType": "customer service"
    },
    "sameAs": [
      "https://www.facebook.com/mktsolucoes",
      "https://www.instagram.com/mktsolucoes"
    ]
  })} />

  <main>
    <HeroCarousel />
    <SectionIntro />
    <Benefits />
    <Products />
    <Clients />
    <WhatsForm />
  </main>
  <Footer />
  <WhatsAppFloat />
</Layout>

<style>
  /* Custom scrollbar for webkit browsers */
  ::-webkit-scrollbar {
    width: 8px;
  }
  
  ::-webkit-scrollbar-track {
    background: #f1f5f9;
  }
  
  ::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, #0ea5e9, #16a34a);
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, #0284c7, #15803d);
  }
  
  /* Smooth scrolling for all browsers */
  html {
    scroll-behavior: smooth;
  }
  
  /* Focus styles for accessibility */
  *:focus {
    outline: 2px solid #0ea5e9;
    outline-offset: 2px;
  }
  
  /* Skip to content link for screen readers */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: #0ea5e9;
    color: white;
    padding: 8px;
    text-decoration: none;
    border-radius: 4px;
    z-index: 1000;
  }
  
  .skip-link:focus {
    top: 6px;
  }
</style>

<script>
  // Performance optimizations
  document.addEventListener('DOMContentLoaded', function() {
    // Lazy load images that are not in viewport
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            if (img.dataset.src) {
              img.src = img.dataset.src;
              img.removeAttribute('data-src');
            }
            observer.unobserve(img);
          }
        });
      });
      
      document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
      });
    }
    
    // Preload critical resources
    const preloadLinks = [
      { href: '/fonts/inter-var.woff2', as: 'font', type: 'font/woff2', crossorigin: 'anonymous' }
    ];
    
    preloadLinks.forEach(link => {
      const linkElement = document.createElement('link');
      linkElement.rel = 'preload';
      linkElement.href = link.href;
      linkElement.as = link.as;
      if (link.type) linkElement.type = link.type;
      if (link.crossorigin) linkElement.crossOrigin = link.crossorigin;
      document.head.appendChild(linkElement);
    });
    
    // Analytics and tracking (placeholder)
    // Replace with your actual analytics code
    if (typeof gtag !== 'undefined') {
      gtag('config', 'GA_MEASUREMENT_ID', {
        page_title: document.title,
        page_location: window.location.href
      });
    }
    
    // Service Worker registration for PWA capabilities
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registered: ', registration);
          })
          .catch(registrationError => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
  });
  
  // Error tracking
  window.addEventListener('error', function(e) {
    // Send error to analytics or error tracking service
    console.error('JavaScript error:', e.error);
  });
  
  // Performance monitoring
  window.addEventListener('load', function() {
    // Measure and report performance metrics
    if ('performance' in window) {
      const perfData = performance.getEntriesByType('navigation')[0];
      const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
      
      // Report to analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'timing_complete', {
          name: 'load',
          value: Math.round(loadTime)
        });
      }
    }
  });
</script>
